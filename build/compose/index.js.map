{"version":3,"sources":["../../source/compose/index.js"],"names":[],"mappings":";;;;;;;;;;iCAAkB,qBAAqB;;;;mCACvB,uBAAuB;;;;qCACf,yBAAyB;;;;AAEjD,IAAM,kBAAkB,GAAG,SAArB,kBAAkB,CAAI,cAAc,EAAE,WAAW,EAAK;AAC1D,SAAO,sCAAI,WAAW,EAAE,UAAA,UAAU,EAAI;AACpC,QAAM,UAAU,GAAG,UAAU,CAAC,OAAO,IAAI,UAAU,CAAC;AACpD,WAAO,UAAU,CAAC,cAAc,CAAC,CAAC;GACnC,CAAC,CAAC;CACJ,CAAC;;AAEF,IAAM,WAAW,GAAG,SAAd,WAAW,CAAI,IAGhB,EAAI;MAFH,OAAO,GADQ,IAGhB,CAFC,OAAO;MAAE,UAAU,GADJ,IAGhB,CAFU,UAAU;MAAE,cAAc,GADpB,IAGhB,CAFsB,cAAc;MAAE,mBAAmB,GADzC,IAGhB,CAFsC,mBAAmB;MAAE,YAAY,GADvD,IAGhB,CAF2D,YAAY;MACtE,gBAAgB,GAFD,IAGhB,CADC,gBAAgB;MAAE,oBAAoB,GAFvB,IAGhB,CADmB,oBAAoB;MAAE,yBAAyB,GAFlD,IAGhB,CADyC,yBAAyB;;AAGrE,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;;AAE7B,MAAM,KAAK,GAAG,SAAS,KAAK,CAAE,OAAO,EAAW;sCAAN,IAAI;AAAJ,UAAI;;;AAC5C,QAAI,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;;AAEjC,wCAAM,GAAG,EAAE,cAAc,CAAC,CAAC;AAC3B,UAAM,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;;AAExB,UAAM,CAAC,gBAAgB,CAAC,GAAG,EAAE,mBAAmB,CAAC,CAAC;;AAElD,gBAAY,CAAC,OAAO,CAAC,UAAA,WAAW,EAAI;AAClC,UAAM,WAAW,GAAG,WAAW,CAAC,IAAI,CAAC,GAAG,EAAE,OAAO,EAC/C,EAAE,QAAQ,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACjE,UAAK,CAAC,wCAAY,WAAW,CAAC,EAAG;AAC/B,WAAG,GAAG,WAAW,CAAC;OACnB;KACF,CAAC,CAAC;;AAEH,WAAO,GAAG,CAAC;GACZ,CAAC;;AAEF,sCAAM,KAAK,EAAE,oBAAoB,CAAC,CAAC;AACnC,QAAM,CAAC,KAAK,EAAE,gBAAgB,CAAC,CAAC;;AAEhC,QAAM,CAAC,gBAAgB,CAAC,KAAK,EAAE,yBAAyB,CAAC,CAAC;;AAE1D,SAAO,KAAK,CAAC;CACd,CAAC;;AAGF,SAAS,OAAO,GAAkB;;;AAChC,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;;AAE7B,MAAM,aAAa,GAAG,SAAhB,aAAa,GAAsB;uCAAN,IAAI;AAAJ,UAAI;;;AACrC,WAAO,OAAO,mBAAC,EAAE,OAAO,EAAE,aAAa,EAAE,SAAK,IAAI,EAAC,CAAC;GACrD,CAAC;;qCALiB,WAAW;AAAX,eAAW;;;AAO9B,MAAM,aAAa,GAAG,iDAAM,EAAE,4BACzB,kBAAkB,CAAC,eAAe,EAAE,WAAW,CAAC,GAAC,CAAC;;AAEvD,QAAM,CAAC,aAAa,EAAE;AACpB,WAAO,EAAE,MAAM,mBAAC,EAAE,4BAAK,kBAAkB,CAAC,SAAS,EAAE,WAAW,CAAC,GAAC;AAClE,kBAAc,EAAE,iDAAM,EAAE,4BACnB,kBAAkB,CAAC,gBAAgB,EAAE,WAAW,CAAC,GAAC;AACvD,cAAU,EAAE,MAAM,mBAAC,EAAE,4BAAK,kBAAkB,CAAC,YAAY,EAAE,WAAW,CAAC,GAAC;AACxE,wBAAoB,EAAE,iDAAM,EAAE,4BACzB,kBAAkB,CAAC,sBAAsB,EAAE,WAAW,CAAC,GAAC;AAC7D,oBAAgB,EAAE,MAAM,mBAAC,EAAE,4BACtB,kBAAkB,CAAC,kBAAkB,EAAE,WAAW,CAAC,GAAC;AACzD,uBAAmB,EAAE,MAAM,mBAAC,EAAE,4BACzB,kBAAkB,CAAC,qBAAqB,EAAE,WAAW,CAAC,GAAC;AAC5D,6BAAyB,EAAE,MAAM,mBAAC,EAAE,4BAC/B,kBAAkB,CAAC,2BAA2B,EAAE,WAAW,CAAC,GAAC;AAClE,gBAAY,EAAE,SAAA,EAAE,EAAC,MAAM,MAAA,2BAAI,kBAAkB,CAAC,cAAc,EAAE,WAAW,CAAC,EAAC,CACxE,MAAM,CAAC,UAAA,WAAW;aAAI,WAAW,KAAK,SAAS;KAAA,CAAC;AACnD,iBAAa,EAAb,aAAa;GACd,CAAC,CAAC;;AAEH,MAAM,KAAK,GAAG,WAAW,CAAC,aAAa,CAAC,CAAC;;AAEzC,OAAK,CAAC,OAAO,GAAG,aAAa,CAAC;;AAE9B,SAAO,KAAK,CAAC;CACd;;qBAEc,OAAO","file":"index.js","sourcesContent":["import merge from 'lodash/object/merge';\nimport map from 'lodash/collection/map';\nimport isUndefined from 'lodash/lang/isUndefined';\n\nconst getDescriptorProps = (descriptorName, composables) => {\n  return map(composables, composable => {\n    const descriptor = composable.compose || composable;\n    return descriptor[descriptorName];\n  });\n};\n\nconst createStamp = ({\n      methods, properties, deepProperties, propertyDescriptors, initializers,\n      staticProperties, deepStaticProperties, staticPropertyDescriptors\n    })=> {\n\n  const assign = Object.assign;\n\n  const Stamp = function Stamp (options, ...args) {\n    let obj = Object.create(methods);\n\n    merge(obj, deepProperties);\n    assign(obj, properties);\n\n    Object.defineProperties(obj, propertyDescriptors);\n\n    initializers.forEach(initializer => {\n      const returnValue = initializer.call(obj, options,\n        { instance: obj, stamp: Stamp, args: [options].concat(args) });\n      if ( !isUndefined(returnValue) ) {\n        obj = returnValue;\n      }\n    });\n\n    return obj;\n  };\n\n  merge(Stamp, deepStaticProperties);\n  assign(Stamp, staticProperties);\n\n  Object.defineProperties(Stamp, staticPropertyDescriptors);\n\n  return Stamp;\n};\n\n\nfunction compose (...composables) {\n  const assign = Object.assign;\n\n  const composeMethod = function (...args) {\n    return compose({ compose: composeMethod }, ...args);\n  };\n\n  const configuration = merge({},\n    ...getDescriptorProps('configuration', composables));\n\n  assign(composeMethod, {\n    methods: assign({}, ...getDescriptorProps('methods', composables)),\n    deepProperties: merge({},\n      ...getDescriptorProps('deepProperties', composables)),\n    properties: assign({}, ...getDescriptorProps('properties', composables)),\n    deepStaticProperties: merge({},\n      ...getDescriptorProps('deepStaticProperties', composables)),\n    staticProperties: assign({},\n      ...getDescriptorProps('staticProperties', composables)),\n    propertyDescriptors: assign({},\n      ...getDescriptorProps('propertyDescriptors', composables)),\n    staticPropertyDescriptors: assign({},\n      ...getDescriptorProps('staticPropertyDescriptors', composables)),\n    initializers: [].concat(...getDescriptorProps('initializers', composables))\n      .filter(initializer => initializer !== undefined),\n    configuration\n  });\n\n  const stamp = createStamp(composeMethod);\n\n  stamp.compose = composeMethod;\n\n  return stamp;\n}\n\nexport default compose;\n"]}